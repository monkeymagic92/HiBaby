<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jy.hibaby.chat.ChatMapper">

	<insert id="insChat" parameterType="ChatPARAM">
		INSERT INTO t_chat
		(to_user, from_user, ctnt)
		VALUES
		(#{to_user}, #{from_user}, #{ctnt})
	</insert>
	
	<select id="selChat" parameterType="ChatPARAM" resultType="ChatPARAM">
		SELECT B.i_user AS from_user, C.i_user AS to_user, B.profile_img AS from_profile_img, C.profile_img AS to_profile_img,
		B.nick, ctnt
		FROM t_chat A
		
		LEFT JOIN t_user B
		ON A.from_user = B.i_user
		
		LEFT JOIN t_user C
		ON A.to_user = C.i_user
		
		WHERE A.to_user = ${to_user} AND A.from_user = ${from_user}
		OR
		A.from_user = ${to_user} AND A.to_user = ${from_user}
	</select>
</mapper>